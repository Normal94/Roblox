LS0gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci0tIFNDUklQVCBFTiBHSVRIVUI6IExJQlJFUsONQSBERSBVSSBNRU7DmiBHQVRPCi0tID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpsb2NhbCBDb3JlR3VpID0gKGdldGh1aSBhbmQgZ2V0aHVpKCkpIG9yIGdhbWU6R2V0U2VydmljZSgiQ29yZUd1aSIpCmxvY2FsIFVzZXJJbnB1dFNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlVzZXJJbnB1dFNlcnZpY2UiKQpsb2NhbCBUd2VlblNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlR3ZWVuU2VydmljZSIpCgpsb2NhbCBMaWJyYXJ5ID0ge30KCmZ1bmN0aW9uIExpYnJhcnk6SW5pdCh0aXRsZVRleHQpCiAgICAtLSAxLiBSRUNVUlNPUwogICAgbG9jYWwgdXJsTG9nbyA9ICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vTm9ybWFsOTQvUm9ibG94L3JlZnMvaGVhZHMvbWFpbi9HQVRPJTIwTUVOVSIKICAgIGxvY2FsIHVybEF1ZGlvID0gImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Ob3JtYWw5NC9Sb2Jsb3gvcmVmcy9oZWFkcy9tYWluL2luaWNpby5tcDMiCiAgICBsb2NhbCBub21icmVMb2dvID0gIkxvZ29HYXRvVjgucG5nIgogICAgbG9jYWwgbm9tYnJlQXVkaW8gPSAiSW5pY2lvR2F0b1Y4Lm1wMyIKCiAgICBsb2NhbCBmdW5jdGlvbiBkZWNvZGlmaWNhckJhc2U2NChkYXRhKQogICAgICAgIGxvY2FsIGIgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLycKICAgICAgICBkYXRhID0gc3RyaW5nLmdzdWIoZGF0YSwgJ1teJy4uYi4uJz1dJywgJycpCiAgICAgICAgcmV0dXJuIChkYXRhOmdzdWIoJy4nLCBmdW5jdGlvbih4KQogICAgICAgICAgICBpZiAoeCA9PSAnPScpIHRoZW4gcmV0dXJuICcnIGVuZAogICAgICAgICAgICBsb2NhbCByLGY9JycsKGI6ZmluZCh4KS0xKQogICAgICAgICAgICBmb3IgaT02LDEsLTEgZG8gcj1yLi4oZiUyXmktZiUyXihpLTEpPjAgYW5kICcxJyBvciAnMCcpIGVuZAogICAgICAgICAgICByZXR1cm4gcjsKICAgICAgICBlbmQpOmdzdWIoJyVkJWQlZD8lZD8lZD8lZD8lZD8lZD8nLCBmdW5jdGlvbih4KQogICAgICAgICAgICBpZiAoI3ggfj0gOCkgdGhlbiByZXR1cm4gJycgZW5kCiAgICAgICAgICAgIGxvY2FsIGM9MAogICAgICAgICAgICBmb3IgaT0xLDggZG8gYz1jKyh4OnN1YihpLGkpPT0nMScgYW5kIDJeKDgtaSkgb3IgMCkgZW5kCiAgICAgICAgICAgIHJldHVybiBzdHJpbmcuY2hhcihjKQogICAgICAgIGVuZCkpCiAgICBlbmQKCiAgICBpZiBub3QgaXNmaWxlKG5vbWJyZUxvZ28pIHRoZW4gCiAgICAgICAgbG9jYWwgcywgciA9IHBjYWxsKGZ1bmN0aW9uKCkgcmV0dXJuIGdhbWU6SHR0cEdldCh1cmxMb2dvKSBlbmQpCiAgICAgICAgaWYgcyBhbmQgciB0aGVuIHdyaXRlZmlsZShub21icmVMb2dvLCBkZWNvZGlmaWNhckJhc2U2NChzdHJpbmcuZ3N1YihyLCAiJXMrIiwgIiIpKSkgZW5kCiAgICBlbmQKICAgIGlmIG5vdCBpc2ZpbGUobm9tYnJlQXVkaW8pIHRoZW4gCiAgICAgICAgbG9jYWwgcywgciA9IHBjYWxsKGZ1bmN0aW9uKCkgcmV0dXJuIGdhbWU6SHR0cEdldCh1cmxBdWRpbykgZW5kKQogICAgICAgIGlmIHMgYW5kIHIgdGhlbiB3cml0ZWZpbGUobm9tYnJlQXVkaW8sIHIpIGVuZAogICAgZW5kCgogICAgaWYgQ29yZUd1aTpGaW5kRmlyc3RDaGlsZCgiTWVudUdhdG9VSSIpIHRoZW4gQ29yZUd1aS5NZW51R2F0b1VJOkRlc3Ryb3koKSBlbmQKCiAgICAtLSAyLiBDUkVBQ0nDk04gREUgTEEgVkVOVEFOQSBCQVNFCiAgICBsb2NhbCBTY3JlZW5HdWkgPSBJbnN0YW5jZS5uZXcoIlNjcmVlbkd1aSIpCiAgICBTY3JlZW5HdWkuTmFtZSA9ICJNZW51R2F0b1VJIgogICAgU2NyZWVuR3VpLlJlc2V0T25TcGF3biA9IGZhbHNlCiAgICBTY3JlZW5HdWkuSWdub3JlR3VpSW5zZXQgPSB0cnVlCiAgICBTY3JlZW5HdWkuUGFyZW50ID0gQ29yZUd1aQoKICAgIGxvY2FsIGZhZGVJbmZvID0gVHdlZW5JbmZvLm5ldygwLjYsIEVudW0uRWFzaW5nU3R5bGUuUXVpbnQsIEVudW0uRWFzaW5nRGlyZWN0aW9uLk91dCkKICAgIGxvY2FsIHR3ZWVuSW5mbyA9IFR3ZWVuSW5mby5uZXcoMC40LCBFbnVtLkVhc2luZ1N0eWxlLlF1aW50LCBFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQpCgogICAgLS0gUGFudGFsbGEgQ2FyZ2EKICAgIGxvY2FsIExvYWRpbmdGcmFtZSA9IEluc3RhbmNlLm5ldygiRnJhbWUiLCBTY3JlZW5HdWkpCiAgICBMb2FkaW5nRnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAxLCAwKQogICAgTG9hZGluZ0ZyYW1lLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMiwgMTIsIDEyKQogICAgTG9hZGluZ0ZyYW1lLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICBMb2FkaW5nRnJhbWUuWkluZGV4ID0gMTAwCgogICAgbG9jYWwgTG9nb0ltYWdlID0gSW5zdGFuY2UubmV3KCJJbWFnZUxhYmVsIiwgTG9hZGluZ0ZyYW1lKQogICAgTG9nb0ltYWdlLlNpemUgPSBVRGltMi5uZXcoMCwgMTYwLCAwLCAxNjApCiAgICBMb2dvSW1hZ2UuUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAtODAsIDAuNSwgLTEwMCkKICAgIExvZ29JbWFnZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgTG9nb0ltYWdlLkltYWdlID0gaXNmaWxlKG5vbWJyZUxvZ28pIGFuZCBnZXRjdXN0b21hc3NldChub21icmVMb2dvKSBvciAicmJ4YXNzZXRpZDovLzc1ODU3NjU0MDIzMTA5IgogICAgTG9nb0ltYWdlLkltYWdlVHJhbnNwYXJlbmN5ID0gMQogICAgTG9nb0ltYWdlLlNjYWxlVHlwZSA9IEVudW0uU2NhbGVUeXBlLkZpdAogICAgTG9nb0ltYWdlLlpJbmRleCA9IDEwMQoKICAgIGxvY2FsIExvYWRpbmdUZXh0ID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiLCBMb2FkaW5nRnJhbWUpCiAgICBMb2FkaW5nVGV4dC5TaXplID0gVURpbTIubmV3KDAsIDIwMCwgMCwgMzApCiAgICBMb2FkaW5nVGV4dC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIC0xMDAsIDAuNSwgNzUpCiAgICBMb2FkaW5nVGV4dC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgTG9hZGluZ1RleHQuVGV4dCA9ICJDYXJnYW5kby4uLiIKICAgIExvYWRpbmdUZXh0LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQogICAgTG9hZGluZ1RleHQuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkCiAgICBMb2FkaW5nVGV4dC5UZXh0U2l6ZSA9IDE2CiAgICBMb2FkaW5nVGV4dC5UZXh0VHJhbnNwYXJlbmN5ID0gMQogICAgTG9hZGluZ1RleHQuWkluZGV4ID0gMTAxCgogICAgLS0gQm90w7NuIEFicmlyCiAgICBsb2NhbCBPcGVuQnV0dG9uID0gSW5zdGFuY2UubmV3KCJUZXh0QnV0dG9uIiwgU2NyZWVuR3VpKQogICAgT3BlbkJ1dHRvbi5TaXplID0gVURpbTIubmV3KDAsIDEwMCwgMCwgMjYpCiAgICBPcGVuQnV0dG9uLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgLTUwLCAwLCA1KQogICAgT3BlbkJ1dHRvbi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjAsIDI1LCAzMCkKICAgIE9wZW5CdXR0b24uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIE9wZW5CdXR0b24uVGV4dCA9ICJNRU7DmiBHQVRPIgogICAgT3BlbkJ1dHRvbi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21IZXgoIiNmOWJiMzUiKQogICAgT3BlbkJ1dHRvbi5Gb250ID0gRW51bS5Gb250LkdvdGhhbQogICAgT3BlbkJ1dHRvbi5UZXh0U2l6ZSA9IDEyCiAgICBPcGVuQnV0dG9uLlRleHRUcmFuc3BhcmVuY3kgPSAxCiAgICBPcGVuQnV0dG9uLlZpc2libGUgPSBmYWxzZQogICAgSW5zdGFuY2UubmV3KCJVSUNvcm5lciIsIE9wZW5CdXR0b24pLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDgpCiAgICBsb2NhbCBPcGVuU3Ryb2tlID0gSW5zdGFuY2UubmV3KCJVSVN0cm9rZSIsIE9wZW5CdXR0b24pCiAgICBPcGVuU3Ryb2tlLkNvbG9yID0gQ29sb3IzLmZyb21IZXgoIiNmOWJiMzUiKQogICAgT3BlblN0cm9rZS5UcmFuc3BhcmVuY3kgPSAxCgogICAgLS0gVmVudGFuYSBQcmluY2lwYWwKICAgIGxvY2FsIE1haW5GcmFtZSA9IEluc3RhbmNlLm5ldygiQ2FudmFzR3JvdXAiLCBTY3JlZW5HdWkpCiAgICBNYWluRnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygwLCA0NTAsIDAsIDM4MCkKICAgIE1haW5GcmFtZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIC0yMjUsIDAuNSwgLTE5MCkKICAgIE1haW5GcmFtZS5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMTUsIDIwLCAyNSkKICAgIE1haW5GcmFtZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC4zCiAgICBNYWluRnJhbWUuR3JvdXBUcmFuc3BhcmVuY3kgPSAxCiAgICBNYWluRnJhbWUuVmlzaWJsZSA9IGZhbHNlCiAgICBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIiwgTWFpbkZyYW1lKS5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLCAxMikKICAgIGxvY2FsIE1haW5TY2FsZSA9IEluc3RhbmNlLm5ldygiVUlTY2FsZSIsIE1haW5GcmFtZSkKICAgIE1haW5TY2FsZS5TY2FsZSA9IDAuOAoKICAgIGxvY2FsIFRvcEJhciA9IEluc3RhbmNlLm5ldygiRnJhbWUiLCBNYWluRnJhbWUpCiAgICBUb3BCYXIuU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCA0MCkKICAgIFRvcEJhci5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQoKICAgIGxvY2FsIFRpdGxlID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiLCBUb3BCYXIpCiAgICBUaXRsZS5TaXplID0gVURpbTIubmV3KDEsIC01MCwgMSwgMCkKICAgIFRpdGxlLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDE1LCAwLCAwKQogICAgVGl0bGUuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIFRpdGxlLlRleHQgPSB0aXRsZVRleHQgb3IgIkhpZGUgJiBTZWVrIFVsdGltYXRlIFt2OF0iCiAgICBUaXRsZS5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKICAgIFRpdGxlLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZAogICAgVGl0bGUuVGV4dFNpemUgPSAxNgogICAgVGl0bGUuVGV4dFhBbGlnbm1lbnQgPSBFbnVtLlRleHRYQWxpZ25tZW50LkxlZnQKCiAgICBsb2NhbCBDbG9zZUJ0biA9IEluc3RhbmNlLm5ldygiVGV4dEJ1dHRvbiIsIFRvcEJhcikKICAgIENsb3NlQnRuLlNpemUgPSBVRGltMi5uZXcoMCwgMzAsIDAsIDMwKQogICAgQ2xvc2VCdG4uUG9zaXRpb24gPSBVRGltMi5uZXcoMSwgLTQwLCAwLCA1KQogICAgQ2xvc2VCdG4uQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDAsIDApCiAgICBDbG9zZUJ0bi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC42CiAgICBDbG9zZUJ0bi5UZXh0ID0gIlgiCiAgICBDbG9zZUJ0bi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjAwLCAyMDAsIDIwMCkKICAgIENsb3NlQnRuLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZAogICAgQ2xvc2VCdG4uVGV4dFNpemUgPSAxNgogICAgSW5zdGFuY2UubmV3KCJVSUNvcm5lciIsIENsb3NlQnRuKS5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLCA4KQoKICAgIGxvY2FsIFRhYkJhciA9IEluc3RhbmNlLm5ldygiU2Nyb2xsaW5nRnJhbWUiLCBNYWluRnJhbWUpCiAgICBUYWJCYXIuU2l6ZSA9IFVEaW0yLm5ldygxLCAtMjAsIDAsIDM1KQogICAgVGFiQmFyLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDEwLCAwLCA0NSkKICAgIFRhYkJhci5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgVGFiQmFyLlNjcm9sbEJhclRoaWNrbmVzcyA9IDAKICAgIGxvY2FsIFRhYkJhckxheW91dCA9IEluc3RhbmNlLm5ldygiVUlMaXN0TGF5b3V0IiwgVGFiQmFyKQogICAgVGFiQmFyTGF5b3V0LkZpbGxEaXJlY3Rpb24gPSBFbnVtLkZpbGxEaXJlY3Rpb24uSG9yaXpvbnRhbAogICAgVGFiQmFyTGF5b3V0LlBhZGRpbmcgPSBVRGltLm5ldygwLCA4KQogICAgVGFiQmFyTGF5b3V0LlNvcnRPcmRlciA9IEVudW0uU29ydE9yZGVyLkxheW91dE9yZGVyCiAgICBUYWJCYXJMYXlvdXQ6R2V0UHJvcGVydHlDaGFuZ2VkU2lnbmFsKCJBYnNvbHV0ZUNvbnRlbnRTaXplIik6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgVGFiQmFyLkNhbnZhc1NpemUgPSBVRGltMi5uZXcoMCwgVGFiQmFyTGF5b3V0LkFic29sdXRlQ29udGVudFNpemUuWCwgMCwgMCkKICAgIGVuZCkKCiAgICBsb2NhbCBQYWdlQ29udGFpbmVyID0gSW5zdGFuY2UubmV3KCJGcmFtZSIsIE1haW5GcmFtZSkKICAgIFBhZ2VDb250YWluZXIuU2l6ZSA9IFVEaW0yLm5ldygxLCAtMjAsIDEsIC05NSkKICAgIFBhZ2VDb250YWluZXIuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMTAsIDAsIDg1KQogICAgUGFnZUNvbnRhaW5lci5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQoKICAgIC0tIEFuaW1hY2lvbmVzIHkgRHJhZwogICAgbG9jYWwgZHJhZ2dpbmcsIGRyYWdTdGFydCwgc3RhcnRQb3MKICAgIFRvcEJhci5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICAgICAgZHJhZ2dpbmcsIGRyYWdTdGFydCwgc3RhcnRQb3MgPSB0cnVlLCBpbnB1dC5Qb3NpdGlvbiwgTWFpbkZyYW1lLlBvc2l0aW9uCiAgICAgICAgICAgIGlucHV0LkNoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbigpIGlmIGlucHV0LlVzZXJJbnB1dFN0YXRlID09IEVudW0uVXNlcklucHV0U3RhdGUuRW5kIHRoZW4gZHJhZ2dpbmcgPSBmYWxzZSBlbmQgZW5kKQogICAgICAgIGVuZAogICAgZW5kKQogICAgVXNlcklucHV0U2VydmljZS5JbnB1dENoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICBpZiBkcmFnZ2luZyBhbmQgKGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2gpIHRoZW4KICAgICAgICAgICAgbG9jYWwgZGVsdGEgPSBpbnB1dC5Qb3NpdGlvbiAtIGRyYWdTdGFydAogICAgICAgICAgICBNYWluRnJhbWUuUG9zaXRpb24gPSBVRGltMi5uZXcoc3RhcnRQb3MuWC5TY2FsZSwgc3RhcnRQb3MuWC5PZmZzZXQgKyBkZWx0YS5YLCBzdGFydFBvcy5ZLlNjYWxlLCBzdGFydFBvcy5ZLk9mZnNldCArIGRlbHRhLlkpCiAgICAgICAgZW5kCiAgICBlbmQpCgogICAgQ2xvc2VCdG4uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShNYWluU2NhbGUsIHR3ZWVuSW5mbywge1NjYWxlID0gMC44fSk6UGxheSgpCiAgICAgICAgbG9jYWwgdCA9IFR3ZWVuU2VydmljZTpDcmVhdGUoTWFpbkZyYW1lLCB0d2VlbkluZm8sIHtHcm91cFRyYW5zcGFyZW5jeSA9IDF9KTsgdDpQbGF5KCk7IHQuQ29tcGxldGVkOldhaXQoKQogICAgICAgIE1haW5GcmFtZS5WaXNpYmxlID0gZmFsc2U7IE9wZW5CdXR0b24uVmlzaWJsZSA9IHRydWUKICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKE9wZW5CdXR0b24sIHR3ZWVuSW5mbywge0JhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjUsIFRleHRUcmFuc3BhcmVuY3kgPSAwfSk6UGxheSgpCiAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShPcGVuU3Ryb2tlLCB0d2VlbkluZm8sIHtUcmFuc3BhcmVuY3kgPSAwLjN9KTpQbGF5KCkKICAgIGVuZCkKCiAgICBPcGVuQnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIFR3ZWVuU2VydmljZTpDcmVhdGUoT3BlbkJ1dHRvbiwgdHdlZW5JbmZvLCB7QmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsIFRleHRUcmFuc3BhcmVuY3kgPSAxfSk6UGxheSgpCiAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShPcGVuU3Ryb2tlLCB0d2VlbkluZm8sIHtUcmFuc3BhcmVuY3kgPSAxfSk6UGxheSgpCiAgICAgICAgdGFzay53YWl0KDAuMik7IE9wZW5CdXR0b24uVmlzaWJsZSA9IGZhbHNlOyBNYWluRnJhbWUuVmlzaWJsZSA9IHRydWUKICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKE1haW5TY2FsZSwgdHdlZW5JbmZvLCB7U2NhbGUgPSAxfSk6UGxheSgpCiAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShNYWluRnJhbWUsIHR3ZWVuSW5mbywge0dyb3VwVHJhbnNwYXJlbmN5ID0gMH0pOlBsYXkoKQogICAgZW5kKQoKICAgIC0tIFNlY3VlbmNpYSBJbmljaW8KICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgIGlmIGlzZmlsZShub21icmVBdWRpbykgdGhlbgogICAgICAgICAgICBsb2NhbCBzID0gSW5zdGFuY2UubmV3KCJTb3VuZCIsIFNjcmVlbkd1aSk7IHMuU291bmRJZCA9IGdldGN1c3RvbWFzc2V0KG5vbWJyZUF1ZGlvKTsgcy5Wb2x1bWUgPSAxLjU7IHM6UGxheSgpCiAgICAgICAgICAgIHMuRW5kZWQ6Q29ubmVjdChmdW5jdGlvbigpIHM6RGVzdHJveSgpIGVuZCkKICAgICAgICBlbmQKICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKExvYWRpbmdGcmFtZSwgZmFkZUluZm8sIHtCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC4xNX0pOlBsYXkoKQogICAgICAgIFR3ZWVuU2VydmljZTpDcmVhdGUoTG9nb0ltYWdlLCBmYWRlSW5mbywge0ltYWdlVHJhbnNwYXJlbmN5ID0gMH0pOlBsYXkoKQogICAgICAgIFR3ZWVuU2VydmljZTpDcmVhdGUoTG9hZGluZ1RleHQsIGZhZGVJbmZvLCB7VGV4dFRyYW5zcGFyZW5jeSA9IDB9KTpQbGF5KCkKICAgICAgICB0YXNrLndhaXQoMi41KQogICAgICAgIFR3ZWVuU2VydmljZTpDcmVhdGUoTG9hZGluZ0ZyYW1lLCBmYWRlSW5mbywge0JhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxfSk6UGxheSgpCiAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShMb2dvSW1hZ2UsIGZhZGVJbmZvLCB7SW1hZ2VUcmFuc3BhcmVuY3kgPSAxfSk6UGxheSgpCiAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShMb2FkaW5nVGV4dCwgZmFkZUluZm8sIHtUZXh0VHJhbnNwYXJlbmN5ID0gMX0pOlBsYXkoKQogICAgICAgIHRhc2sud2FpdCgwLjYpOyBMb2FkaW5nRnJhbWU6RGVzdHJveSgpOyBNYWluRnJhbWUuVmlzaWJsZSA9IHRydWUKICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKE1haW5GcmFtZSwgZmFkZUluZm8sIHtHcm91cFRyYW5zcGFyZW5jeSA9IDB9KTpQbGF5KCkKICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKE1haW5TY2FsZSwgVHdlZW5JbmZvLm5ldygwLjUsIEVudW0uRWFzaW5nU3R5bGUuQmFjaywgRW51bS5FYXNpbmdEaXJlY3Rpb24uT3V0KSwge1NjYWxlID0gMX0pOlBsYXkoKQogICAgZW5kKQoKICAgIGxvY2FsIGFjdGl2ZVRhYkJ0biwgYWN0aXZlUGFnZSA9IG5pbCwgbmlsCiAgICBsb2NhbCBXaW5kb3dBUEkgPSB7fQoKICAgIC0tIDMuIEZVTkNJT05FUyBQQVJBIENSRUFSIENPTlRFTklETwogICAgZnVuY3Rpb24gV2luZG93QVBJOkNyZWF0ZVRhYihuYW1lKQogICAgICAgIGxvY2FsIGJ0biA9IEluc3RhbmNlLm5ldygiVGV4dEJ1dHRvbiIsIFRhYkJhcikKICAgICAgICBidG4uU2l6ZSA9IFVEaW0yLm5ldygwLCAxMDAsIDEsIC01KQogICAgICAgIGJ0bi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKICAgICAgICBidG4uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuOQogICAgICAgIGJ0bi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjAwLCAyMDAsIDIwMCkKICAgICAgICBidG4uRm9udCA9IEVudW0uRm9udC5Hb3RoYW1NZWRpdW07IGJ0bi5UZXh0U2l6ZSA9IDEyOyBidG4uVGV4dCA9IG5hbWU7IGJ0bi5BdXRvQnV0dG9uQ29sb3IgPSBmYWxzZQogICAgICAgIEluc3RhbmNlLm5ldygiVUlDb3JuZXIiLCBidG4pLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDgpCiAgICAgICAgCiAgICAgICAgbG9jYWwgcGFnZSA9IEluc3RhbmNlLm5ldygiU2Nyb2xsaW5nRnJhbWUiLCBQYWdlQ29udGFpbmVyKQogICAgICAgIHBhZ2UuU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAxLCAwKQogICAgICAgIHBhZ2UuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDE7IHBhZ2UuU2Nyb2xsQmFyVGhpY2tuZXNzID0gMjsgcGFnZS5WaXNpYmxlID0gZmFsc2UKICAgICAgICBsb2NhbCBsYXlvdXQgPSBJbnN0YW5jZS5uZXcoIlVJTGlzdExheW91dCIsIHBhZ2UpCiAgICAgICAgbGF5b3V0LlBhZGRpbmcgPSBVRGltLm5ldygwLCA4KTsgbGF5b3V0LlNvcnRPcmRlciA9IEVudW0uU29ydE9yZGVyLkxheW91dE9yZGVyCiAgICAgICAgbGF5b3V0OkdldFByb3BlcnR5Q2hhbmdlZFNpZ25hbCgiQWJzb2x1dGVDb250ZW50U2l6ZSIpOkNvbm5lY3QoZnVuY3Rpb24oKSBwYWdlLkNhbnZhc1NpemUgPSBVRGltMi5uZXcoMCwgMCwgMCwgbGF5b3V0LkFic29sdXRlQ29udGVudFNpemUuWSArIDIwKSBlbmQpCgogICAgICAgIGJ0bi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgaWYgYWN0aXZlVGFiQnRuIHRoZW4gYWN0aXZlVGFiQnRuLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjk7IGFjdGl2ZVRhYkJ0bi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjAwLCAyMDAsIDIwMCk7IGFjdGl2ZVBhZ2UuVmlzaWJsZSA9IGZhbHNlIGVuZAogICAgICAgICAgICBhY3RpdmVUYWJCdG4gPSBidG47IGFjdGl2ZVBhZ2UgPSBwYWdlCiAgICAgICAgICAgIGJ0bi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC4yOyBidG4uVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDIwLCAyMCwgMjApOyBwYWdlLlZpc2libGUgPSB0cnVlCiAgICAgICAgZW5kKQogICAgICAgIGlmIG5vdCBhY3RpdmVUYWJCdG4gdGhlbiBidG4uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuMjsgYnRuLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyMCwgMjAsIDIwKTsgcGFnZS5WaXNpYmxlID0gdHJ1ZTsgYWN0aXZlVGFiQnRuID0gYnRuOyBhY3RpdmVQYWdlID0gcGFnZSBlbmQKCiAgICAgICAgLS0gTcOpdG9kb3MgZGUgbGEgUGVzdGHDsWEKICAgICAgICBsb2NhbCBUYWJBUEkgPSB7fQogICAgICAgIGZ1bmN0aW9uIFRhYkFQSTpBZGRMYWJlbCh0ZXh0KQogICAgICAgICAgICBsb2NhbCBsYmwgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIsIHBhZ2UpCiAgICAgICAgICAgIGxibC5TaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDIwKTsgbGJsLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxOyBsYmwuVGV4dCA9IHRleHQKICAgICAgICAgICAgbGJsLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbUhleCgiI2Y5YmIzNSIpOyBsYmwuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkOyBsYmwuVGV4dFNpemUgPSAxMzsgbGJsLlRleHRYQWxpZ25tZW50ID0gRW51bS5UZXh0WEFsaWdubWVudC5MZWZ0CiAgICAgICAgZW5kCiAgICAgICAgZnVuY3Rpb24gVGFiQVBJOkFkZEJ1dHRvbih0ZXh0LCBjYWxsYmFjaykKICAgICAgICAgICAgbG9jYWwgYiA9IEluc3RhbmNlLm5ldygiVGV4dEJ1dHRvbiIsIHBhZ2UpCiAgICAgICAgICAgIGIuU2l6ZSA9IFVEaW0yLm5ldygxLCAtNSwgMCwgMzIpOyBiLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KTsgYi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC45CiAgICAgICAgICAgIGIuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpOyBiLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtTWVkaXVtOyBiLlRleHRTaXplID0gMTI7IGIuVGV4dCA9IHRleHQKICAgICAgICAgICAgSW5zdGFuY2UubmV3KCJVSUNvcm5lciIsIGIpLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDgpCiAgICAgICAgICAgIGxvY2FsIHMgPSBJbnN0YW5jZS5uZXcoIlVJU3Ryb2tlIiwgYik7IHMuQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigyNTUsMjU1LDI1NSk7IHMuVHJhbnNwYXJlbmN5ID0gMC44NQogICAgICAgICAgICBiLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoY2FsbGJhY2spCiAgICAgICAgICAgIHJldHVybiBiCiAgICAgICAgZW5kCiAgICAgICAgZnVuY3Rpb24gVGFiQVBJOkFkZFRvZ2dsZSh0ZXh0LCBjYWxsYmFjaykKICAgICAgICAgICAgbG9jYWwgc3RhdGUgPSBmYWxzZQogICAgICAgICAgICBsb2NhbCBiID0gSW5zdGFuY2UubmV3KCJUZXh0QnV0dG9uIiwgcGFnZSkKICAgICAgICAgICAgYi5TaXplID0gVURpbTIubmV3KDEsIC01LCAwLCAzMik7IGIuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpOyBiLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjkKICAgICAgICAgICAgYi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSk7IGIuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1NZWRpdW07IGIuVGV4dFNpemUgPSAxMjsgYi5UZXh0ID0gdGV4dAogICAgICAgICAgICBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIiwgYikuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgOCkKICAgICAgICAgICAgbG9jYWwgcyA9IEluc3RhbmNlLm5ldygiVUlTdHJva2UiLCBiKTsgcy5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDI1NSwyNTUsMjU1KTsgcy5UcmFuc3BhcmVuY3kgPSAwLjg1CiAgICAgICAgICAgIGIuTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBzdGF0ZSA9IG5vdCBzdGF0ZTsgYi5UZXh0ID0gc3RhdGUgYW5kICgi4pyTICIgLi4gdGV4dCkgb3IgdGV4dAogICAgICAgICAgICAgICAgYi5UZXh0Q29sb3IzID0gc3RhdGUgYW5kIENvbG9yMy5mcm9tSGV4KCIjRDRFOUQ4Iikgb3IgQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKICAgICAgICAgICAgICAgIHMuQ29sb3IgPSBzdGF0ZSBhbmQgQ29sb3IzLmZyb21IZXgoIiNENEU5RDgiKSBvciBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQogICAgICAgICAgICAgICAgY2FsbGJhY2soc3RhdGUpCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgICAgICBmdW5jdGlvbiBUYWJBUEk6QWRkU2xpZGVyKHRleHQsIG1pbiwgbWF4LCBkZWZhdWx0LCBjYWxsYmFjaykKICAgICAgICAgICAgbG9jYWwgZnJhbWUgPSBJbnN0YW5jZS5uZXcoIkZyYW1lIiwgcGFnZSkKICAgICAgICAgICAgZnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygxLCAtNSwgMCwgNDUpOyBmcmFtZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgICAgICAgICBsb2NhbCBsYmwgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIsIGZyYW1lKQogICAgICAgICAgICBsYmwuU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAxNSk7IGxibC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMTsgbGJsLlRleHQgPSB0ZXh0IC4uICI6ICIgLi4gZGVmYXVsdAogICAgICAgICAgICBsYmwuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpOyBsYmwuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1NZWRpdW07IGxibC5UZXh0U2l6ZSA9IDEyOyBsYmwuVGV4dFhBbGlnbm1lbnQgPSBFbnVtLlRleHRYQWxpZ25tZW50LkxlZnQKICAgICAgICAgICAgbG9jYWwgYmFyID0gSW5zdGFuY2UubmV3KCJUZXh0QnV0dG9uIiwgZnJhbWUpCiAgICAgICAgICAgIGJhci5TaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDgpOyBiYXIuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMCwgMCwgMjUpOyBiYXIuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpCiAgICAgICAgICAgIGJhci5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC44OyBiYXIuVGV4dCA9ICIiCiAgICAgICAgICAgIEluc3RhbmNlLm5ldygiVUlDb3JuZXIiLCBiYXIpLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDEsIDApCiAgICAgICAgICAgIGxvY2FsIGZpbGwgPSBJbnN0YW5jZS5uZXcoIkZyYW1lIiwgYmFyKQogICAgICAgICAgICBmaWxsLlNpemUgPSBVRGltMi5uZXcoKGRlZmF1bHQgLSBtaW4pIC8gKG1heCAtIG1pbiksIDEsIDApOyBmaWxsLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbUhleCgiI0Q0RTlEOCIpCiAgICAgICAgICAgIEluc3RhbmNlLm5ldygiVUlDb3JuZXIiLCBmaWxsKS5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygxLCAwKQogICAgICAgICAgICBsb2NhbCBkcmFnZ2luZyA9IGZhbHNlCiAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIHVwZGF0ZVNsaWRlcihpbnB1dCkKICAgICAgICAgICAgICAgIGxvY2FsIHBvcyA9IG1hdGguY2xhbXAoKGlucHV0LlBvc2l0aW9uLlggLSBiYXIuQWJzb2x1dGVQb3NpdGlvbi5YKSAvIGJhci5BYnNvbHV0ZVNpemUuWCwgMCwgMSkKICAgICAgICAgICAgICAgIGZpbGwuU2l6ZSA9IFVEaW0yLm5ldyhwb3MsIDAsIDEsIDApOyBsb2NhbCB2YWwgPSBtYXRoLmZsb29yKG1pbiArIChtYXggLSBtaW4pICogcG9zKQogICAgICAgICAgICAgICAgbGJsLlRleHQgPSB0ZXh0IC4uICI6ICIgLi4gdmFsOyBjYWxsYmFjayh2YWwpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBiYXIuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KSBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbiBkcmFnZ2luZyA9IHRydWUgdXBkYXRlU2xpZGVyKGlucHV0KSBlbmQgZW5kKQogICAgICAgICAgICBVc2VySW5wdXRTZXJ2aWNlLklucHV0RW5kZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCkgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4gZHJhZ2dpbmcgPSBmYWxzZSBlbmQgZW5kKQogICAgICAgICAgICBVc2VySW5wdXRTZXJ2aWNlLklucHV0Q2hhbmdlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KSBpZiBkcmFnZ2luZyBhbmQgKGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2gpIHRoZW4gdXBkYXRlU2xpZGVyKGlucHV0KSBlbmQgZW5kKQogICAgICAgIGVuZAogICAgICAgIGZ1bmN0aW9uIFRhYkFQSTpBZGRJbnB1dChwbGFjZWhvbGRlciwgY2FsbGJhY2spCiAgICAgICAgICAgIGxvY2FsIGJveCA9IEluc3RhbmNlLm5ldygiVGV4dEJveCIsIHBhZ2UpCiAgICAgICAgICAgIGJveC5TaXplID0gVURpbTIubmV3KDEsIC01LCAwLCAzMik7IGJveC5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSk7IGJveC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC45CiAgICAgICAgICAgIGJveC5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSk7IGJveC5Gb250ID0gRW51bS5Gb250LkdvdGhhbU1lZGl1bTsgYm94LlRleHRTaXplID0gMTIKICAgICAgICAgICAgYm94LlBsYWNlaG9sZGVyVGV4dCA9IHBsYWNlaG9sZGVyOyBib3guVGV4dCA9ICIiOyBib3guQ2xlYXJUZXh0T25Gb2N1cyA9IGZhbHNlCiAgICAgICAgICAgIEluc3RhbmNlLm5ldygiVUlDb3JuZXIiLCBib3gpLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDgpCiAgICAgICAgICAgIGxvY2FsIHMgPSBJbnN0YW5jZS5uZXcoIlVJU3Ryb2tlIiwgYm94KTsgcy5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDI1NSwyNTUsMjU1KTsgcy5UcmFuc3BhcmVuY3kgPSAwLjg1CiAgICAgICAgICAgIGJveC5Gb2N1c0xvc3Q6Q29ubmVjdChmdW5jdGlvbihlbnRlcikgaWYgZW50ZXIgdGhlbiBjYWxsYmFjayhib3guVGV4dCkgZW5kIGVuZCkKICAgICAgICAgICAgcmV0dXJuIGJveAogICAgICAgIGVuZAogICAgICAgIHJldHVybiBUYWJBUEkKICAgIGVuZAoKICAgIHJldHVybiBXaW5kb3dBUEkKZW5kCgpyZXR1cm4gTGlicmFyeQo
